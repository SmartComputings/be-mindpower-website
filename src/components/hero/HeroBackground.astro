---
// Fondo: negro + resplandor azul + video
---

<div class="hero-background">
  <div class="hero-bg-base"></div>
  
  <!-- Background video -->
  <video
    id="home-hero-video"
    class="hero-bg-video"
    autoplay
    loop
    muted
    playsinline
    preload="auto"
  >
    <source src="/asad/an1.mp4" type="video/mp4" />
  </video>
  
  <div class="hero-glow"></div>
</div>


<style>
  .hero-background {
    position: absolute;
    inset: 0;
    z-index: 1;
    overflow: hidden;
    pointer-events: none;
    background-color: #000000;
  }

  .hero-bg-base {
    position: absolute;
    inset: 0;
    background-color: #000000;
    opacity: 0.98;
  }
  
  .hero-bg-video {
    position: absolute;
    top: 50%;
    left: 50%;
    min-width: 100%;
    min-height: 100%;
    width: auto;
    height: auto;
    transform: translate(-50%, -50%);
    object-fit: cover;
    object-position: center;
    z-index: 1;
    opacity: 0.75;
    transition: opacity 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
  }

  @media (max-width: 768px) {
    .hero-bg-video {
      width: 100vw;
      height: 100vh;
      object-fit: cover;
    }
  }

  .hero-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: min(1284px, 150vw);
    height: min(1284px, 150vw);
    background: radial-gradient(
      circle,
      rgba(40, 54, 233, 0.89) 0%,
      rgba(40, 54, 233, 0.5) 40%,
      transparent 70%
    );
    filter: blur(198px);
    z-index: 1;
  }

  @media (max-width: 1024px) {
    .hero-glow {
      width: min(900px, 130vw);
      height: min(900px, 130vw);
    }
  }

  @media (max-width: 768px) {
    .hero-glow {
      width: min(700px, 150vw);
      height: min(700px, 150vw);
      filter: blur(100px);
    }
  }

  @media (max-width: 480px) {
    .hero-glow {
      width: min(500px, 180vw);
      height: min(500px, 180vw);
      filter: blur(60px);
    }
  }
</style>

<script>
  // Initialize background video  
  function initHeroBackgroundVideo(): void {
    const video = document.getElementById('home-hero-video') as HTMLVideoElement;
    if (!video) return;

    const playVideo = () => {
      const playPromise = video.play();
      if (playPromise !== undefined) {
        playPromise.catch(() => {
          video.muted = true;
          video.play().catch(() => {});
        });
      }
    };

    // Ensure video loops smoothly
    video.addEventListener('ended', () => {
      video.currentTime = 0;
      video.play().catch(() => {});
    });

    if (video.readyState >= 2) {
      playVideo();
    } else {
      video.addEventListener('loadeddata', playVideo, { once: true });
    }
    
    // Ensure opacity transition is set
    video.style.transition = 'opacity 0.5s cubic-bezier(0.25, 0.1, 0.25, 1)';
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initHeroBackgroundVideo);
  } else {
    initHeroBackgroundVideo();
  }
  
  document.addEventListener('astro:page-load', initHeroBackgroundVideo);
</script>
