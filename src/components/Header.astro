---
import Logo from './Logo.astro';
import Navigation from './Navigation.astro';

interface Props {
  currentPath?: string;
  backgroundImage?: string;
}

const { currentPath, backgroundImage = '/asad/headerbg.png' } = Astro.props;
---

<header class="fixed left-0 right-0 top-6 z-40">
  <!-- Decorative backdrop for header (subtle, used for scroll state) -->
  <div 
    id="header-bg" 
    class="absolute inset-0 pointer-events-none opacity-0 transition-opacity duration-300"
  ></div>

  <div class="relative w-full min-[900px]:max-w-[80%] mx-auto px-4">
    <div class="flex items-center justify-center">
      <div 
        class="w-full bg-none min-[900px]:bg-cover min-[900px]:bg-center min-[900px]:rounded-full px-0 min-[900px]:px-8 py-3 min-[900px]:border min-[900px]:border-white/10 min-[900px]:shadow-[0_8px_40px_rgba(18,12,40,0.6)] min-[900px]:backdrop-blur-md header-container"
        style={`--bg-image: url('${backgroundImage}');`}
      >
        <div class="relative flex items-center justify-between w-full min-[900px]:w-auto max-w-[1400px] mx-auto">
          <div class="flex items-center w-full min-[900px]:w-auto min-[900px]:flex-1 justify-center min-[900px]:justify-start">
            <a href="/" class="flex items-center gap-2.5 no-underline shrink-0" aria-label="BeMind Power - Inicio">
              <picture>
                <source media="(max-width: 768px)" srcset="/images/logos/Logo_Be-Mind%20night.png" />
                <img src="/images/logos/Logo_Be-Mind%20night.svg" alt="BeMind Power" class="h-12 min-[900px]:h-10 w-auto" />
              </picture>
            </a>
          </div>

          <div class="absolute right-0 min-[900px]:relative min-[900px]:flex-1 flex items-center justify-end min-[900px]:justify-center">
            <Navigation currentPath={currentPath} />
          </div>

          <div class="hidden min-[900px]:flex flex-1 items-center justify-end gap-3">
            <a href="/registro" class="hidden min-[900px]:inline-block px-9 py-2 rounded-full text-base font-semibold text-white shadow-md bg-gradient-to-r from-[#ff4fb8] to-[#a43cff] hover:opacity-95 disabled">Registro</a>
            <a href="/login" class="hidden min-[900px]:inline-block px-11 py-2 rounded-full text-base font-semibold text-white shadow-md bg-gradient-to-r from-[#2aa6ff] to-[#235bff] hover:opacity-95">Login</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  const initHeaderScroll = () => {
    const headerBg = document.getElementById('header-bg');
    if (!headerBg) return;

    const updateHeader = () => {
      if (window.scrollY > 50) {
        headerBg.classList.remove('opacity-0');
        headerBg.classList.add('opacity-100');
      } else {
        headerBg.classList.add('opacity-0');
        headerBg.classList.remove('opacity-100');
      }
    };

    window.addEventListener('scroll', updateHeader, { passive: true });
    updateHeader();
  };

  // Initialize on page load (handles initial load and view transitions)
  document.addEventListener('astro:page-load', initHeaderScroll);
</script>
